import{R as oe,r,K as se,U as ae,a6 as ne,c as G,a7 as re,$ as U,d as W,k as le,l as n,B as k}from"./index-BFlqfnX8.js";import{I as L}from"./index-Cc3DaH-3.js";import{M as ce}from"./index-D3IYcu92.js";function K(s){return["small","middle","large"].includes(s)}function J(s){return s?typeof s=="number"&&!Number.isNaN(s):!1}const q=oe.createContext({latestIndex:0}),ie=q.Provider,de=s=>{let{className:c,index:l,children:a,split:i,style:u}=s;const{latestIndex:m}=r.useContext(q);return a==null?null:r.createElement(r.Fragment,null,r.createElement("div",{className:c,style:u},a),l<m&&i&&r.createElement("span",{className:`${c}-split`},i))};var pe=function(s,c){var l={};for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&c.indexOf(a)<0&&(l[a]=s[a]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,a=Object.getOwnPropertySymbols(s);i<a.length;i++)c.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(s,a[i])&&(l[a[i]]=s[a[i]]);return l};const ue=r.forwardRef((s,c)=>{var l;const{getPrefixCls:a,direction:i,size:u,className:m,style:g,classNames:z,styles:x}=se("space"),{size:d=u??"small",align:j,className:b,rootClassName:w,children:P,direction:T="horizontal",prefixCls:O,split:I,style:A,wrap:F=!1,classNames:v,styles:C}=s,S=pe(s,["size","align","className","rootClassName","children","direction","prefixCls","split","style","wrap","classNames","styles"]),[f,h]=Array.isArray(d)?d:[d,d],N=K(h),E=K(f),H=J(h),B=J(f),e=ae(P,{keepEmpty:!0}),o=j===void 0&&T==="horizontal"?"center":j,t=a("space",O),[p,_,X]=ne(t),Y=G(t,m,_,`${t}-${T}`,{[`${t}-rtl`]:i==="rtl",[`${t}-align-${o}`]:o,[`${t}-gap-row-${h}`]:N,[`${t}-gap-col-${f}`]:E},b,w,X),M=G(`${t}-item`,(l=v==null?void 0:v.item)!==null&&l!==void 0?l:z.item);let D=0;const Z=e.map((y,R)=>{var V;y!=null&&(D=R);const te=(y==null?void 0:y.key)||`${M}-${R}`;return r.createElement(de,{className:M,key:te,index:R,split:I,style:(V=C==null?void 0:C.item)!==null&&V!==void 0?V:x.item},y)}),ee=r.useMemo(()=>({latestIndex:D}),[D]);if(e.length===0)return null;const $={};return F&&($.flexWrap="wrap"),!E&&B&&($.columnGap=f),!N&&H&&($.rowGap=h),p(r.createElement("div",Object.assign({ref:c,className:Y,style:Object.assign(Object.assign(Object.assign({},$),g),A)},S),r.createElement(ie,{value:ee},Z)))}),Q=ue;Q.Compact=re;var me={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M864 256H736v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zm-200 0H360v-72h304v72z"}}]},name:"delete",theme:"filled"},he=function(c,l){return r.createElement(U,W({},c,{ref:l,icon:me}))},fe=r.forwardRef(he),ye={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32zm-622.3-84c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9z"}}]},name:"edit",theme:"filled"},ge=function(c,l){return r.createElement(U,W({},c,{ref:l,icon:ye}))},xe=r.forwardRef(ge);function je(){const[s,c]=r.useState(""),[l,a]=r.useState([]),[i,u]=r.useState(null),[m,g]=r.useState(""),[z,x]=r.useState(!1),d=localStorage.getItem("myToken"),j=le(),b=e=>{j(e)},w=()=>{x(!0)},P=()=>{x(!1)},T=()=>{x(!1)};r.useEffect(()=>{(async()=>{if(d){const o=await f(d);a(o),console.log(o)}else console.log("Token is missing")})()},[d]);const O=e=>{c(e.target.value)},I=async e=>{if(e.key==="Enter"){if(s.trim()===""){w();return}console.log(s);const t=await h({title:s},d);a(p=>[...p,t]),c("")}};r.useState("");const A=async()=>{if(s.trim()===""){w();return}console.log(s);const o=await h({title:s},d);a(t=>[...t,o]),c("")},F=async e=>{const o=l.map(t=>t.id===e.id?{...t,isCompleted:!t.isCompleted}:{...t,isCompleted:t.isCompleted});a(o);try{await E(e.id,d),console.log(e)}catch(t){console.log("Error updating task completion: ",t),a(o)}},v=async e=>{console.log(e,"delete");try{await N(e.id,d);const o=l.filter(t=>t.id!==e.id);a(o)}catch(o){console.log("Error deleting task: ",o)}},C=e=>{u(e.id),g(e.title)},S=async e=>{const o=l.map(t=>t.id===e.id?{...t,title:m}:t);await H({title:m},e.id,d),console.log({title:m}),a(o),u(null),g("")};async function f(e){try{const o=await fetch("https://todo-redev.herokuapp.com/api/todos",{method:"GET",headers:{Authorization:`Bearer ${e}`}});if(!o.ok)throw new Error("Failed to fetch tasks");const t=await o.json();return console.log(t),t}catch(o){console.log("error: ",o)}}async function h(e,o){try{return await(await fetch("https://todo-redev.herokuapp.com/api/todos",{method:"POST",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"},body:JSON.stringify(e)})).json()}catch(t){console.log("error: ",t)}}async function N(e,o){try{return await(await fetch(`https://todo-redev.herokuapp.com/api/todos/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${o}`}})).json()}catch(t){console.log("error: ",t)}}async function E(e,o){try{return await(await fetch(`https://todo-redev.herokuapp.com/api/todos/${e}/isCompleted`,{method:"PATCH",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"}})).json()}catch(t){console.log("error: ",t)}}async function H(e,o,t){try{return await(await fetch(`https://todo-redev.herokuapp.com/api/todos/${o}`,{method:"PATCH",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify(e)})).json()}catch(p){console.log("error: ",p)}}const B=()=>{localStorage.removeItem("myToken"),b("/login")};return n.jsxs(n.Fragment,{children:[n.jsxs("section",{className:"container",children:[n.jsx("h1",{children:"Get things done!"}),n.jsxs(Q.Compact,{style:{width:"100%"},children:[n.jsx(L,{value:s,placeholder:"What is the task today?",onChange:O,onKeyDown:I}),n.jsx(k,{type:"primary",onClick:A,children:"Add task"})]}),l.length>0&&n.jsx("ul",{children:l.map(e=>n.jsx("li",{style:{display:"flex",alignItems:"center"},children:i===e.id?n.jsxs(n.Fragment,{children:[n.jsx(L,{value:m,onChange:o=>g(o.target.value),onPressEnter:()=>S(e),style:{flex:1}}),n.jsx(k,{type:"primary",onClick:()=>S(e),children:"Update"})]}):n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"task-text",onClick:()=>F(e),style:{textDecoration:e.isCompleted?"line-through":"none",cursor:"pointer",flex:1},children:e.title}),n.jsx(k,{type:"primary",onClick:o=>{o.stopPropagation(),C(e)},children:n.jsx(xe,{})}),n.jsx(k,{type:"primary",onClick:o=>{o.stopPropagation(),v(e)},children:n.jsx(fe,{})})]})},e.id))}),n.jsx(k,{type:"primary",onClick:B,children:"Log out"})]}),n.jsx(ce,{title:"Please inter task",open:z,onOk:P,onCancel:T})]})}export{je as TaskPage};
